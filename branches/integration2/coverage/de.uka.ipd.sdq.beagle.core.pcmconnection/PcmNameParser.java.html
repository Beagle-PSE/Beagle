<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PcmNameParser.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Core</a> &gt; <a href="index.source.html" class="el_package">de.uka.ipd.sdq.beagle.core.pcmconnection</a> &gt; <span class="el_source">PcmNameParser.java</span></div><h1>PcmNameParser.java</h1><pre class="source lang-java linenums">package de.uka.ipd.sdq.beagle.core.pcmconnection;

import de.uka.ipd.sdq.beagle.core.CodeSection;
import de.uka.ipd.sdq.beagle.core.facade.SourceCodeFileProvider;

import java.io.File;
import java.io.FileNotFoundException;

/**
 * ****************************EXTINCT****************************************************
 * ******** This parser is a draft that can only provide proper functionality if SoMoX
 * does not change its naming convention for EntityNames. It offers one method
 * {@link PcmNameParser#parse} to read out the {@link CodeSection CodeSections} in a given
 * String. Attention! This Parser can not read out as much as desired for the
 * {@link CodeSection}. For more information, read through the java-doc of the method
 * {@link parse}.
 * ***************************************************************************************
 * ******** No more usage of this class is made so far.
 *
 * @author Ansgar Spiegler
 * @author Roman Langrehr
 *
 */
public class PcmNameParser {

	/**
	 * &quot;@position: &quot; annotation in the entity name.
	 */
	private static final String AT_POSITION_COLON_SPACE = &quot;@position: &quot;;

	/**
	 * &quot;DOTjava&quot; annotation in the entity name.
	 */
	private static final String DOT_JAVA = &quot;.java&quot;;

	/**
	 * &quot; from &quot; annotation in the entity name.
	 */
	private static final String SPACE_FROM_SPACE = &quot; from &quot;;

	/**
	 * &quot; to &quot; annotation in the entity name.
	 */
	private static final String SPACE_TO_SPACE = &quot; to &quot;;

	/**
	 * &quot; at &quot; annotation in the entity name.
	 */
	private static final String SPACE_AT_SPACE = &quot; at &quot;;

	/**
	 * The {@link CodeSection} that should be created.
	 */
	private CodeSection codeSection;

	/**
	 * The position of &quot; from &quot; in the given String.
	 */
	private int fromOffset;

	/**
	 * The position of &quot; to &quot; in the given String.
	 */
	private int toOffset;

	/**
	 * The position of &quot; at &quot; in the given String.
	 */
	private int atOffset;

	/**
	 * The file that is created by the relative path between &quot;@position: &quot; and &quot;.java&quot;.
	 */
	private File file;

	/**
	 * The from-Position marking the sourceCode.
	 */
	private int fromPos;

	/**
	 * The to-Position marking the sourceCode.
	 */
	private int toPos;

	/**
	 * The at-Position marking the sourceCode.
	 */
	private int atPos;

	/**
	 * The {@link SourceCodeFileProvider} for the project under analysis.
	 */
	private final SourceCodeFileProvider sourceCodeFileProvider;

	/**
	 * Creates a new name parser for a specific project to analyse.
	 *
	 * @param sourceCodeFileProvider The {@link SourceCodeFileProvider} for the project
	 *            under analysis.
	 */
<span class="nc" id="L102">	public PcmNameParser(final SourceCodeFileProvider sourceCodeFileProvider) {</span>
<span class="nc" id="L103">		this.sourceCodeFileProvider = sourceCodeFileProvider;</span>
<span class="nc" id="L104">	}</span>

	/**
	 * Parsing a SoMoX-created String to get the annotated CodeSection.
	 *
	 * @param entityName SoMoX generated entityName. If not, this leads to undefined
	 *            behaviour.
	 * @return May return {@code null}, if the String contains no file-path
	 *         {@link CodeSection}. Initialized with (file, firstOffset, file,
	 *         secondOffset) OR (file, firstOffset, file, firstOffset) if there is no
	 *         second Offset available. Anyway, the first &quot;file&quot; and the second &quot;file&quot; are
	 *         the same!
	 * @throws FileNotFoundException When the file was not found at the given relative
	 *             path.
	 */
	public CodeSection parse(final String entityName) throws FileNotFoundException {

<span class="nc" id="L121">		this.reset();</span>
<span class="nc" id="L122">		this.loadFile(entityName);</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">		if (this.file == null) {</span>
<span class="nc" id="L124">			return null;</span>
		}

<span class="nc" id="L127">		this.fromPos = entityName.indexOf(PcmNameParser.SPACE_FROM_SPACE);</span>
<span class="nc" id="L128">		this.toPos = entityName.indexOf(PcmNameParser.SPACE_TO_SPACE);</span>
<span class="nc bnc" id="L129" title="All 4 branches missed.">		if (this.fromPos != -1 &amp;&amp; this.toPos != -1) {</span>

<span class="nc" id="L131">			this.fromOffset = Integer</span>
<span class="nc" id="L132">				.parseInt(entityName.substring(this.fromPos + PcmNameParser.SPACE_FROM_SPACE.length(), this.toPos));</span>
<span class="nc" id="L133">			this.toOffset = Integer.parseInt(</span>
<span class="nc" id="L134">				entityName.substring(this.toPos + PcmNameParser.SPACE_TO_SPACE.length(), entityName.length()));</span>

<span class="nc" id="L136">			this.codeSection = new CodeSection(this.file, this.fromOffset, this.file, this.toOffset);</span>

		} else {
<span class="nc" id="L139">			this.atPos = entityName.indexOf(PcmNameParser.SPACE_AT_SPACE);</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">			if (this.atPos != -1) {</span>
<span class="nc" id="L141">				this.atOffset = Integer.parseInt(</span>
<span class="nc" id="L142">					entityName.substring(this.atPos + PcmNameParser.SPACE_AT_SPACE.length(), entityName.length()));</span>

<span class="nc" id="L144">				this.codeSection = new CodeSection(this.file, this.atOffset, this.file, this.atOffset);</span>
			}
		}

<span class="nc" id="L148">		return this.codeSection;</span>

	}

	/**
	 * Tries to load the file, looking at the given substring between &quot;@position: &quot; and
	 * &quot;.java&quot;. May set {@link file} to null if no file annotation was found. Otherwise
	 * {@line file} is set to the .java file at the given position.
	 *
	 * @param entityName The full entityName.
	 *
	 * @throws FileNotFoundException Tries to load a file at the given path. If no valid
	 *             file can be loaded at a given position, this exception is thrown.
	 */
	private void loadFile(final String entityName) throws FileNotFoundException {
		final String qualifiedName;
<span class="nc" id="L164">		final int position = entityName.indexOf(PcmNameParser.AT_POSITION_COLON_SPACE);</span>
<span class="nc" id="L165">		final int blockPos = entityName.indexOf(PcmNameParser.DOT_JAVA);</span>

<span class="nc bnc" id="L167" title="All 4 branches missed.">		if (position != -1 &amp;&amp; blockPos != -1) {</span>
<span class="nc" id="L168">			qualifiedName = entityName.substring(position + PcmNameParser.AT_POSITION_COLON_SPACE.length(), blockPos);</span>
<span class="nc" id="L169">			this.file = this.sourceCodeFileProvider.getSourceFile(qualifiedName);</span>

<span class="nc bnc" id="L171" title="All 2 branches missed.">			if (this.file == null) {</span>
<span class="nc" id="L172">				throw new FileNotFoundException(&quot;No source file for class &quot; + qualifiedName + &quot; was found.&quot;);</span>

			}

		} else {
<span class="nc" id="L177">			this.file = null;</span>
		}
<span class="nc" id="L179">	}</span>

	/**
	 * Reset/initialising step of all storing variables.
	 *
	 */
	private void reset() {
<span class="nc" id="L186">		this.codeSection = null;</span>

<span class="nc" id="L188">		this.fromOffset = -1;</span>
<span class="nc" id="L189">		this.toOffset = -1;</span>
<span class="nc" id="L190">		this.atOffset = -1;</span>
<span class="nc" id="L191">		this.file = null;</span>

<span class="nc" id="L193">		this.fromPos = -1;</span>
<span class="nc" id="L194">		this.toPos = -1;</span>
<span class="nc" id="L195">		this.atPos = -1;</span>
<span class="nc" id="L196">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.1.201405082137</span></div></body></html>